!function(e){function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=1)}([function(e,n,t){"use strict";function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();e.exports=function(){function e(){i(this,e),this._newContent=null,this._newContentPromise=Promise.resolve(),this._viewElement=document.querySelector("section.view-content"),this._isAnimatingOut=!1,this._isAnimatingIn=!1,this._spinnerTimeout=0,this._currentPath=window.location.pathname,this._boostrapNavigation(),this._onChanged()}return o(e,[{key:"_queueSpinner",value:function(){this._spinnerTimeout=setTimeout(function(){document.body.classList.add("view-pending")},500)}},{key:"_hideSpinner",value:function(){document.body.classList.remove("view-pending"),clearTimeout(this._spinnerTimeout)}},{key:"_onChanged",value:function(){var e=this;return console.log("Router::_onChanged("+window.location.pathname+")"),this._currentPath===window.location.pathname?(console.log("Bumping request"),Promise.resolve()):(this._currentPath=window.location.pathname,this._newContentPromise=this._loadAsyncView(),this._isAnimatingOut?(console.log(" Either animating out or loading still - sorry"),Promise.resolve()):(this._isAnimatingOut=!0,this._animateOut().then(function(){return console.log("Router::_animateOut complete"),e._isAnimatingOut=!1,e._newContentPromise}).then(function(){return console.log("Async View Resolved With "+e._newContent.getAttribute("id")),e._viewElement.innerHTML=e._newContent.innerHTML,e._animatingIn=!0,e._animateIn()}).then(function(){console.log("Router::_animateIn complete"),e._animatingIn=!1}).catch(function(e){console.warn(e)})))}},{key:"_loadAsyncView",value:function(){var e=this;return console.log("Router::_loadAsyncView("+this._currentPath+")"),new Promise(function(n,t){var i=new XMLHttpRequest;i.onload=function(t){e._newContent=t.target.response.querySelector("div[view]"),console.log(e._newContent),n()},i.onerror=t,i.responseType="document",console.log("XHR open"),i.open("GET",e._currentPath+(e._currentPath.endsWith("/")?"":"/")+"?partial"),i.send()})}},{key:"_animateIn",value:function(){var e=this;return console.log("Router::_animateIn()"),this._hideSpinner(),new Promise(function(n,t){var i=function t(){e._viewElement.removeEventListener("transitionend",t),n()};e._viewElement.classList.add("visible"),e._viewElement.addEventListener("transitionend",i)})}},{key:"_animateOut",value:function(){var e=this;return console.log("Router::_animateOut()"),document.body.classList.contains("view-pending")?(console.log("Already pending - not going to anim out"),Promise.resolve()):(this._queueSpinner(),new Promise(function(n,t){var i=function t(){e._viewElement.removeEventListener("transitionend",t),n()};e._viewElement.classList.remove("visible"),e._viewElement.addEventListener("transitionend",i)}))}},{key:"go",value:function(e){return window.history.pushState(null,null,e),this._onChanged()}},{key:"_boostrapNavigation",value:function(){var e=this;window.addEventListener("popstate",this._onChanged.bind(this)),Array.prototype.forEach.call(document.querySelectorAll(".header .header-content nav li"),function(n){console.log("Attaching listener"),n.addEventListener("click",function(n){e.go(n.target.firstChild.href)}),n.firstChild.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),n.click()})})}}]),e}()},function(e,n,t){"use strict";function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),r=t(0);new(function(){function e(){i(this,e),this._router=new r,this._registerServiceWorker(),document.querySelector("nav").addEventListener("click",function(){document.querySelector('input[type="checkbox"]').click()})}return o(e,[{key:"_registerServiceWorker",value:function(){"serviceWorker"in navigator&&(console.warn("About to load the service worker yay"),navigator.serviceWorker.register("/sw.js",{scope:"/"}))}}]),e}())}]);